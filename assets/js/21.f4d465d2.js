(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{376:function(t,s,a){"use strict";a.r(s);var n=a(25),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"性能优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能优化"}},[t._v("#")]),t._v(" 性能优化")]),t._v(" "),a("ul",[a("li",[t._v("资源传输优化\n"),a("ul",[a("li",[t._v("启用 Gzip 压缩")]),t._v(" "),a("li",[t._v("启用 Keep-Alive 长连接")]),t._v(" "),a("li",[t._v("使用 HTTP 资源缓存")]),t._v(" "),a("li",[t._v("使用 Service Worker （离线缓存）")]),t._v(" "),a("li",[t._v("使用服务端渲染（SSR）")]),t._v(" "),a("li",[t._v("设置资源预加载（"),a("code",[t._v("preload")]),t._v(" or "),a("code",[t._v("prefetch")]),t._v("）")])])]),t._v(" "),a("li",[t._v("资源优化\n"),a("ul",[a("li",[t._v("图片懒加载（原生 or 第三方库）")]),t._v(" "),a("li",[t._v("图片格式化")]),t._v(" "),a("li",[t._v("字体优化（"),a("code",[t._v("font-display")]),t._v("）")]),t._v(" "),a("li",[t._v("图标优化（IconFont or svg）")])])]),t._v(" "),a("li",[t._v("渲染优化\n"),a("ul",[a("li",[t._v("避免重排重绘")]),t._v(" "),a("li",[t._v("代码分割，读写分离")]),t._v(" "),a("li",[t._v("路由懒加载")])])]),t._v(" "),a("li",[t._v("CSS 优化\n"),a("ul",[a("li",[t._v("不用 table 布局，改用 flexbox 布局")]),t._v(" "),a("li",[t._v("使用 "),a("code",[t._v("transform")])]),t._v(" "),a("li",[t._v("频繁操作 DOM，可以先将 DOM 离线（"),a("code",[t._v("display: none")]),t._v("）")])])]),t._v(" "),a("li",[t._v("JS 优化\n"),a("ul",[a("li",[t._v("函数防抖、节流")])])])]),t._v(" "),a("h2",{attrs:{id:"rail模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rail模型"}},[t._v("#")]),t._v(" RAIL模型")]),t._v(" "),a("p",[t._v("RAIL 是一个以用户为中心的性能模型，它把用户的体验拆分成几个关键点，并且定义好了每一个的性能指标")]),t._v(" "),a("p",[t._v("有以下四方面：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Response —— 事件处理最好在 50ms 内完成")])]),t._v(" "),a("li",[a("strong",[t._v("Animation —— 在 10ms 内产生一帧")])]),t._v(" "),a("li",[a("strong",[t._v("Idle —— 最大化空闲时间")])]),t._v(" "),a("li",[a("strong",[t._v("Load —— 传输内容到页面可交互的时间不超过 5 秒")])])]),t._v(" "),a("h3",{attrs:{id:"response"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#response"}},[t._v("#")]),t._v(" Response")]),t._v(" "),a("h5",{attrs:{id:"目标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目标"}},[t._v("#")]),t._v(" 目标")]),t._v(" "),a("ul",[a("li",[t._v("用户的输入到响应的时间不超过 100ms，给用户的感受是瞬间就完成")])]),t._v(" "),a("h5",{attrs:{id:"优化方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化方案"}},[t._v("#")]),t._v(" 优化方案")]),t._v(" "),a("ul",[a("li",[t._v("事件处理函数在 50ms 内完成，考虑到 idle task 的情况，事件会排队，等待时间大概在 50ms")]),t._v(" "),a("li",[t._v("复杂的 js 计算尽可能放在后台，如 web worker，避免对用户输入造成阻塞")]),t._v(" "),a("li",[t._v("超过50ms的响应，一定要提供反馈，比如倒计时，进度百分比等")])]),t._v(" "),a("blockquote",[a("p",[t._v("idle task：除了要处理输入事件，浏览器还有其它任务要做，这些任务会占用部分时间，一般情况会花费 50ms 的时间，输入事件的响应则排在其后")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/jinle0703/img-host/master/blog/idleTask%E7%A4%BA%E6%84%8F%E5%9B%BE",alt:"Idle Task示意图"}})]),t._v(" "),a("h3",{attrs:{id:"animation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#animation"}},[t._v("#")]),t._v(" Animation")]),t._v(" "),a("h5",{attrs:{id:"目标-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目标-2"}},[t._v("#")]),t._v(" 目标")]),t._v(" "),a("ul",[a("li",[t._v("产生每一帧的时间不要超过 10ms，为了保证浏览器 60 帧，每一帧的时间在 16ms 左右，但浏览器需要用 6ms 来渲染每一帧")])]),t._v(" "),a("h5",{attrs:{id:"优化方案-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化方案-2"}},[t._v("#")]),t._v(" 优化方案")]),t._v(" "),a("h3",{attrs:{id:"idle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#idle"}},[t._v("#")]),t._v(" Idle")]),t._v(" "),a("h5",{attrs:{id:"目标-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目标-3"}},[t._v("#")]),t._v(" 目标")]),t._v(" "),a("ul",[a("li",[t._v("最大化空闲时间，以增大 50ms 内响应用户输入的几率")])]),t._v(" "),a("h5",{attrs:{id:"优化方案-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化方案-3"}},[t._v("#")]),t._v(" 优化方案")]),t._v(" "),a("ul",[a("li",[t._v("用空闲时间来完成一些延后的工作，如先加载页面可见的部分，然后利用空闲时间加载剩余部分")]),t._v(" "),a("li",[t._v("在空闲时间内执行的任务尽量控制在 50ms 以内")]),t._v(" "),a("li",[t._v("如果用户在空闲时间任务进行时进行交互，必须以此为最高优先级，并暂停空闲时间的任务")])]),t._v(" "),a("h3",{attrs:{id:"load"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#load"}},[t._v("#")]),t._v(" Load")]),t._v(" "),a("h5",{attrs:{id:"目标-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目标-4"}},[t._v("#")]),t._v(" 目标")]),t._v(" "),a("ul",[a("li",[t._v("优化加载速度，可以根据设备、网络等条件。目前，比较好的一个方式是，让页面在一个中配的 3G 网络手机上打开时间不超过 5 秒")]),t._v(" "),a("li",[t._v("对于第二次打开，尽量不超过 2 秒")])]),t._v(" "),a("h5",{attrs:{id:"优化方案-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化方案-4"}},[t._v("#")]),t._v(" 优化方案")]),t._v(" "),a("ul",[a("li",[t._v("在手机设备上测试加载性能，选用中配的 3G 网络（400kb/s，400ms RTT），可以使用 "),a("strong",[t._v("WebPageTest")]),t._v(" 来测试")]),t._v(" "),a("li",[t._v("禁用渲染阻塞的资源，延后加载")]),t._v(" "),a("li",[t._v("让第一次加载的资源更少")])]),t._v(" "),a("h2",{attrs:{id:"渲染优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渲染优化"}},[t._v("#")]),t._v(" 渲染优化")]),t._v(" "),a("h3",{attrs:{id:"重排-回流"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重排-回流"}},[t._v("#")]),t._v(" 重排/回流")]),t._v(" "),a("p",[t._v("重排也就是回流，对性能开销比较大，一般是元素的几何位置发生变化，浏览器触发重新布局")]),t._v(" "),a("p",[t._v("以下操作会触发回流：")]),t._v(" "),a("ul",[a("li",[t._v("页面初次渲染（开销最大）")]),t._v(" "),a("li",[t._v("添加、删除可见 DOM 元素")]),t._v(" "),a("li",[t._v("移动元素位置")]),t._v(" "),a("li",[t._v("改变元素尺寸，比如边距、填充、边框、宽度和高度等")]),t._v(" "),a("li",[t._v("改变元素内容，比如文字数量，图片大小等")]),t._v(" "),a("li",[t._v("改变元素字体大小")]),t._v(" "),a("li",[t._v("改变浏览器窗口尺寸")]),t._v(" "),a("li",[t._v("激活CSS伪类（例如："),a("code",[t._v(":hover")]),t._v("）")]),t._v(" "),a("li",[t._v("设置 style 属性的值")]),t._v(" "),a("li",[t._v("获取 offsetTop、scrollTop、clientTop 等（浏览器需要重新计算）")])]),t._v(" "),a("h4",{attrs:{id:"优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化"}},[t._v("#")]),t._v(" 优化")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("样式集中改变")]),t._v(" "),a("ul",[a("li",[t._v("静态页面尽量更改类名而不是样式")]),t._v(" "),a("li",[t._v("动态页面尽量统一更改")])])]),t._v(" "),a("li",[a("strong",[t._v("分离读写操作")])]),t._v(" "),a("li",[a("strong",[t._v("将 DOM 离线")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("display: none")]),t._v(" 会触发一次重排，可将其设置后进行变更操作后，再设置 "),a("code",[t._v("display")]),t._v(" 属性")]),t._v(" "),a("li",[a("code",[t._v("documentFragment")]),t._v(" 创建一个 DOM 碎片进行批量操作")]),t._v(" "),a("li",[t._v("复制节点后变更再替换原本节点")])])]),t._v(" "),a("li",[a("strong",[t._v("脱离文档流")]),t._v(" "),a("ul",[a("li",[t._v("使用 "),a("code",[t._v("absolute | fixed")]),t._v(" 会使的该元素单独成为渲染树中 "),a("code",[t._v("body")]),t._v(" 的一个子元素，重排开销比较小")])])]),t._v(" "),a("li",[a("strong",[t._v("优化动画")])])]),t._v(" "),a("h3",{attrs:{id:"布局抖动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#布局抖动"}},[t._v("#")]),t._v(" 布局抖动")]),t._v(" "),a("p",[t._v("当我们的代码执行一系列连续的读取和写入 DOM 时会发生布局抖动，迫使浏览器重新计算布局信息，造成 Web 应用程序产生更慢、更少的响应")]),t._v(" "),a("h4",{attrs:{id:"优化-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化-2"}},[t._v("#")]),t._v(" 优化")]),t._v(" "),a("ul",[a("li",[t._v("读写分离，批量的读取和写入，如 "),a("a",{attrs:{href:"https://github.com/wilsonpage/fastdom",target:"_blank",rel:"noopener noreferrer"}},[t._v("fastdom"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("避免回流，可以用 tarnsform-translate 来做位移")])]),t._v(" "),a("h3",{attrs:{id:"重绘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重绘"}},[t._v("#")]),t._v(" 重绘")]),t._v(" "),a("p",[t._v("修改了元素的背景颜色等外观属性，不引发布局阶段直接进入绘制阶段就是重绘")]),t._v(" "),a("h3",{attrs:{id:"requestanimationframe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requestanimationframe"}},[t._v("#")]),t._v(" requestAnimationFrame")]),t._v(" "),a("p",[t._v("requestAnimationFrame 是浏览器用于定时循环操作的一个接口，类似于 setTimeout，主要用途是按帧对网页进行重绘")]),t._v(" "),a("p",[t._v("requestAnimationFrame 最大的优势是 "),a("strong",[t._v("由系统来决定回调函数的执行时机，它能保证回调函数在屏幕每一次的刷新间隔中只被执行一次（在触发重新布局前）")])]),t._v(" "),a("p",[t._v("requestAnimationFrame 还能 "),a("strong",[t._v("节约 CPU 资源")]),t._v("，一旦页面不处于浏览器的当前标签，就会自动停止刷新")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestAnimationFrame")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 动画操作")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h3",{attrs:{id:"contain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#contain"}},[t._v("#")]),t._v(" contain")]),t._v(" "),a("p",[t._v("利用 "),a("code",[t._v("contain：layout")]),t._v("，与浏览器进行沟通，设置当前元素和它的内容尽可能独立于 DOM 树的其他部分")]),t._v(" "),a("p",[t._v("这使得浏览器在重新计算布局、样式、绘图、大小或这四项的组合时，只影响到有限的 DOM 区域，而不是整个页面，可以有效改善性能")]),t._v(" "),a("p",[t._v("比如：有一个 "),a("code",[t._v("ul")]),t._v(" 列表里面显示着倒序的数据，如果对第一个 "),a("code",[t._v("li")]),t._v(" 插入内容会触发列表重新渲染，如果使用 "),a("code",[t._v("contain")]),t._v(" 属性插入操作就只改变被修改 "),a("code",[t._v("li")]),t._v(" ，不影响其它元素")]),t._v(" "),a("h2",{attrs:{id:"资源加载优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源加载优化"}},[t._v("#")]),t._v(" 资源加载优化")]),t._v(" "),a("h3",{attrs:{id:"图片懒加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图片懒加载"}},[t._v("#")]),t._v(" 图片懒加载")]),t._v(" "),a("p",[t._v("原生 "),a("code",[t._v("img")]),t._v(" 标签已经支持懒加载，添加 "),a("code",[t._v("loading='lazy'")]),t._v(" 属性即可")]),t._v(" "),a("p",[t._v("推荐使用第三方懒加载库，拓展性和兼容性会更好")]),t._v(" "),a("h3",{attrs:{id:"字体优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字体优化"}},[t._v("#")]),t._v(" 字体优化")]),t._v(" "),a("p",[t._v("CSS 开始支持 "),a("code",[t._v("@font-face")]),t._v(" 这个指令后，可以加载自定义的字体文件，用户在浏览网站的时候，会下载 "),a("code",[t._v("@font-face")]),t._v(" 中指定的字体")]),t._v(" "),a("p",[t._v("浏览器加载 Web Fonts 按顺序有三个时期：")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("阻塞期（Block Period）")]),t._v(" —— 在此期间如果字体没有加载完成，那么浏览器会使用 "),a("code",[t._v("font-family")]),t._v(" 指定的字体列表中的后备字体（Fallback）进行渲染，但是显示为空白，也就是对于用户是不可见的。在此期间字体加载完成之后才能正常显示该字体")]),t._v(" "),a("li",[a("strong",[t._v("交换期（Swap Period）")]),t._v(" —— 跟阻塞期类似，但是在这个时期内，它会在字体加载时，先用后备字体渲染文本并显示出来（而不是显示空白），在此期间字体加载完成之后才能正常的显示该字体")]),t._v(" "),a("li",[a("strong",[t._v("失败期（Failure Period）")]),t._v(" —— 如果字体加载失败，则使用后备字体显示文本")])]),t._v(" "),a("p",[t._v("每个时期的时长是由 "),a("code",[t._v("font-display")]),t._v(" 决定的")]),t._v(" "),a("h4",{attrs:{id:"font-display"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#font-display"}},[t._v("#")]),t._v(" font-display")]),t._v(" "),a("p",[a("code",[t._v("font-display")]),t._v(" 确切的说不是 CSS 属性，而是专用于 "),a("code",[t._v("@font-face")]),t._v(" 指令的描述符，它可以取如下几个值：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("auto")]),t._v("  —— 这个是 "),a("code",[t._v("font-display")]),t._v(" 的默认值，字体的加载过程由浏览器自行决定，不过基本上和取值为 "),a("code",[t._v("block")]),t._v(" 时的处理方式一致")]),t._v(" "),a("li",[a("code",[t._v("block")]),t._v(" —— 在字体加载前，会使用备用字体渲染，但是显示为空白，使得它一直处于阻塞期，当字体加载完成之后，进入交换期，用下载下来的字体进行文本渲染。不过有些浏览器并不会无限的处于阻塞期，会有超时限制，"),a("strong",[t._v("一般在 3s 后，如果阻塞期仍然没有加载完字体，那么直接就进入交换期，显示后备字体（而非空白），等字体下载完成之后直接替换")])]),t._v(" "),a("li",[a("code",[t._v("swap")]),t._v(" —— 基本上没有阻塞期，直接进入交换期，"),a("strong",[t._v("使用后备字体渲染文本，等用到的字体加载完成之后替换掉后备字体")])]),t._v(" "),a("li",[a("code",[t._v("fallback")]),t._v(" —— 阻塞期很短（大约 100ms），也就是说会有大约 "),a("strong",[t._v("100ms 的显示空白的后备字体")]),t._v("，然后交换期也有时限（大约 3s ），在这段时间内 "),a("strong",[t._v("如果字体加载成功了就会替换成该字体，如果没有加载成功那么后续会一直使用后备字体渲染文本")])]),t._v(" "),a("li",[a("code",[t._v("optional")]),t._v(" —— 阻塞期很短（大约 100ms），但是没有交换期，**如果在阻塞期的 100ms 内字体加载完成，那么会使用该字体，否则直接使用后备字体。**这个就是说指定的网络字体是可有可无的，如果加载很快那么可以显示，加载稍微慢一点就不会显示了，适合网络情况不好的时候，例如移动网络")])]),t._v(" "),a("p",[a("strong",[t._v("使用 "),a("code",[t._v("swap")]),t._v(" 属性可以有效减少用户看不见字体的时间")])]),t._v(" "),a("h3",{attrs:{id:"预加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预加载"}},[t._v("#")]),t._v(" 预加载")]),t._v(" "),a("h4",{attrs:{id:"preload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#preload"}},[t._v("#")]),t._v(" preload")]),t._v(" "),a("p",[t._v("提前加载较晚出现，但对当前页面非常重要的资源")]),t._v(" "),a("p",[t._v("不像 prefetch 有可能被浏览器忽略，浏览器必须请求 preload 标记的资源")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("preload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("image.png"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("as")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h4",{attrs:{id:"prefetch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prefetch"}},[t._v("#")]),t._v(" prefetch")]),t._v(" "),a("p",[t._v("如果我们确定某个资源将来一定会被使用到，我们可以让浏览器预先请求该资源并放入浏览器缓存中")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("prefetch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("image.png"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("as")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("**预获取对 webfonts 性能提升非常明显。**目前，字体文件必须等到 DOM 和 CSS 构建完成之后才开始下载，使用预获取就可以轻松绕过该瓶颈")]),t._v(" "),a("h2",{attrs:{id:"常用-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用-api"}},[t._v("#")]),t._v(" 常用 API")]),t._v(" "),a("h3",{attrs:{id:"时间节点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#时间节点"}},[t._v("#")]),t._v(" 时间节点")]),t._v(" "),a("p",[a("code",[t._v("performance.getEntriesByType('navigation')[0]")]),t._v(" 可以获取一个有关时间节点的对象")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取首次可交互时间")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'load'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Time to Interactive 可交互时间")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" timing "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" performance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntriesByType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'navigation'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domInteractive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fetchStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" diff "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("domInteractive "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" timing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fetchStart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TTI: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" diff"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("ul",[a("li",[t._v("DNS 解析耗时 —— domainLookupEnd - domainLookupStart")]),t._v(" "),a("li",[t._v("TCP 连接耗时 —— connectEnd - connectStart")]),t._v(" "),a("li",[t._v("SSL 安全连接耗时 —— connectEnd - secureConnectionStart")]),t._v(" "),a("li",[t._v("网络请求耗时（TTFB） —— responseStart - requestStart")]),t._v(" "),a("li",[t._v("数据传输耗时 —— responseEnd - responseStart")]),t._v(" "),a("li",[t._v("DOM 解析耗时 —— domInteractive - responseEnd")]),t._v(" "),a("li",[t._v("资源加载耗时 —— loadEventStart - domContentLoadedEventEnd")]),t._v(" "),a("li",[t._v("First Byte 时间 —— responseStart - domainLookupStart")]),t._v(" "),a("li",[t._v("白屏时间 —— responseEnd - fetchStart")]),t._v(" "),a("li",[t._v("首次可交互时间 —— domInteractive - fetchStart")]),t._v(" "),a("li",[t._v("DOM Ready 时间 —— domContentLoadEventEnd - fetchStart")]),t._v(" "),a("li",[t._v("页面完全加载时间 —— loadEventStart - fetchStart")]),t._v(" "),a("li",[t._v("http 头部大小 —— transferSize - encodedBodySize")]),t._v(" "),a("li",[t._v("重定向次数 —— performance.navigation.redirectCount")]),t._v(" "),a("li",[t._v("重定向耗时 —— redirectEnd - redirectStart")])]),t._v(" "),a("h3",{attrs:{id:"观察长任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#观察长任务"}},[t._v("#")]),t._v(" 观察长任务")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 观察长任务")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" observer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PerformanceObserver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entry "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nobserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("entryTypes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'longtask'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("h3",{attrs:{id:"页面可见性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#页面可见性"}},[t._v("#")]),t._v(" 页面可见性")]),t._v(" "),a("p",[t._v("监听 "),a("code",[t._v("visibilitychange")]),t._v(" 事件可以监控页面的可见性（显示 or 隐藏）")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 见面可见性的状态监听")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" vEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'visibilitychange'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webkitHidden "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webkit 事件名称")]),t._v("\n    vEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'webkitvisibilitychange'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("visibilityChanged")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hidden "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webkitHidden"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Web page is hidden."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Web page is visible."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ndocument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" visibilityChanged"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br")])]),a("h3",{attrs:{id:"网络状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络状态"}},[t._v("#")]),t._v(" 网络状态")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取网络状态")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" connection "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" navigator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connection "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" navigator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mozConnection "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" navigator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webkitConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("effectiveType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateConnectionStatus")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Connection type changed from "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" to "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("effectiveType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("effectiveType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nconnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'change'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" updateConnectionStatus"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("h2",{attrs:{id:"性能测试工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能测试工具"}},[t._v("#")]),t._v(" 性能测试工具")]),t._v(" "),a("ul",[a("li",[t._v("WebPageTest")]),t._v(" "),a("li",[t._v("Chrome lightHouse")]),t._v(" "),a("li",[t._v("Chrome DevTools")])]),t._v(" "),a("h2",{attrs:{id:"webpagetest-本地部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpagetest-本地部署"}},[t._v("#")]),t._v(" WebPageTest 本地部署")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("拉取镜像")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("docker pull webpagetest/server\n\ndocker pull webpagetest/agent\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("运行实例")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('docker run -d -p 4000:80 --rm webpagetest/server\n\ndocker run -d -p 4001:80 --network="host" -e "SERVER_URL=http://localhost:4000/work/" -e "LOCATION=Test" webpagetest/agent\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);